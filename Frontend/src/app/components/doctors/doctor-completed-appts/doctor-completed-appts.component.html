<main class="search-section">
  <div class="modern-search-bar">
    <input type="search" placeholder="Search appointments, patients, or more..." [(ngModel)]="search"
      (ngModelChange)="onSearchChange()">
    <button type="submit"><i class="fas fa-search"></i></button>
  </div>
</main>

@if(getAllCompleteAppointments.length > 0) {
<section class="dashboard-container">
  <div class="dashboard-title">
    <i class="fa-solid fa-circle-check"></i>
    Completed Appointments
  </div>
  <div class="appointments-list">
    @for (appointment of filteredAppointments; track $index) {
    <div class="appointment-card">
      <div class="user-title"><i class="fa-solid fa-user"></i> {{ appointment.patientName }}</div>
      <div class="user-age">Age: {{ appointment.patientAge }}</div>
      @if(appointment.patientProblem !== "") {
      <div class="appt-detail"><span class="appt-label">Patient Problem:</span> {{ appointment.patientProblem }}</div>
      }
      <div class="appt-detail"><span class="appt-label">Booking Time:</span> {{ appointment.bookingTime |
        date:'dd-MM-yyyy, hh:mm a' }}</div>
      <div class="appt-detail"><span class="appt-label">Appointment Date:</span> {{ appointment.appointmentDate }}</div>
      <div class="appt-detail"><span class="appt-label">Appointment No.:</span> APPT#{{ appointment.appointmentNumber }}
      </div>
      <div class="action-buttons">
        <button class="btn btn-view" (click)="view(appointment.userId, appointment._id)"><i
            class="fa-solid fa-eye me-1"></i> View</button>
      </div>
    </div>
    }
  </div>

</section>
}@else {
  <div class="no-appt-container">
    <div class="no-appt-icon">
      <i class="fa-regular fa-face-smile-beam"></i>
    </div>
    <div class="no-appt-title">
      No Completed Appointments
    </div>
    <div class="no-appt-sub">
      Once you mark appointments as completed,<br>
      theyâ€™ll appear here automatically.
    </div>
  </div>
}



<div class="modal fade show" tabindex="-1" style="display: block;" *ngIf="showViewModal" aria-modal="true" role="dialog">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content clinic-modal-content">

      <!-- Modal Header -->
      <div class="modal-header clinic-modal-header">
        <h5 class="modal-title fw-semibold mb-0">
          <i class="fa-solid fa-calendar-check me-2"></i>Appointment Overview
        </h5>
        <button type="button" class="btn-close btn-close-white" (click)="closeModal()" aria-label="Close"></button>
      </div>

      <!-- Modal Body -->
      <div class="modal-body clinic-modal-body px-4 py-3">
        <!-- User Info -->
        <h6 class="fw-bold mb-3 clinic-section-label">
          <i class="fa-solid fa-user me-2 icon-muted"></i>User Details
        </h6>
        <ul class="list-unstyled ps-3 mb-4">
          <li class="mb-1"><strong class="clinic-label-key">Name:</strong> <span class="clinic-label-value">{{ userName }}</span></li>
          <li class="mb-1"><strong class="clinic-label-key">Phone:</strong> <span class="clinic-label-value">{{ userPhone }}</span></li>
          <li class="mb-1"><strong class="clinic-label-key">Email:</strong> <span class="clinic-label-value">{{ userEmail }}</span></li>
        </ul>

        <!-- Patient Info -->
        <h6 class="fw-bold mb-3 clinic-section-label">
          <i class="fa-solid fa-hospital-user me-2 icon-muted"></i>Patient Details
        </h6>
        <ul class="list-unstyled ps-3">
          <li class="mb-1"><strong class="clinic-label-key">Name:</strong> <span class="clinic-label-value">{{ patientName }}</span></li>
          <li class="mb-1"><strong class="clinic-label-key">Age:</strong> <span class="clinic-label-value">{{ patientAge }}</span></li>
        </ul>
      </div>

      <!-- Modal Footer -->
      <div class="modal-footer border-0 rounded-bottom-4 px-4 py-3 justify-content-end">
        <button type="button" class="btn btn-modal-outline rounded-pill px-4" (click)="closeModal()">
          <i class="fa-solid fa-xmark me-2"></i>Close
        </button>
      </div>
    </div>
  </div>
</div>

