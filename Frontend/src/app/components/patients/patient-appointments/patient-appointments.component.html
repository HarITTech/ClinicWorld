<div class="welcome-user">Welcome, {{username}}</div>

<h3 class="text-center text-highlight fw-semibold my-4">
  <i class="fa-solid fa-calendar-check me-2"></i> Today's Appointments
</h3>
@if(appointments && appointments.length > 0){
<div class="container py-4">
  <div class="row">
    @for(appointment of appointments; track $index){
    <div class="col-lg-6 col-sm-12 col-md-6 mb-3">
      <div class="card compact-card rounded-4 p-3">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h4 class="mb-0 fw-bold text-highlight">{{appointment.appt.patientName}}</h4>
          @if(appointment.appt.patientStatus === 'completed'){
          <span class="badge status-completed">Completed</span>
          }@else if (appointment.appt.patientStatus === 'notCheck') {
          <span class="badge status-notcheck">Not Check</span>
          }@else {
          <span class="badge status-inprocess">In Process</span>
          }
        </div>

        <p class="mb-1 small"><strong>Age:</strong> {{appointment.appt.patientAge}}</p>
        <p class="mb-1 small"><strong>Date:</strong> {{appointment.appt.appointmentDate}}</p>
        <p class="mb-1 small"><strong>Appointment No:</strong> {{appointment.appt.appointmentNumber}}</p>
        <p class="mb-1 small"><strong>Doctor:</strong> {{appointment.name}}</p>
        <p class="mb-2 small"><strong>Phone:</strong> {{appointment.phone}}</p>

        <!-- âœ… Edit Button -->
        <div class="text-end mt-2">
          @if(appointment.appt.patientStatus !== 'completed'){
          <button class="animeted-button" (click)="updateAppointment(appointment.doctorId, appointment.appt._id)">
            <i class="fa-solid fa-pen-to-square me-1"></i> Edit
          </button>
          @if(appointment.appt.patientStatus !== 'notCheck'){
          <button class="animeted-button" (click)="openDeleteModal(appointment.doctorId, appointment.appt._id)">
            <i class="fa-solid fa-trash me-1"></i> Delete
          </button>
          }
          }
        </div>

      </div>
    </div>
    }
  </div>
</div>
}



<!-- Edit Appointment Modal -->
<div class="modal fade show d-block" tabindex="-1" *ngIf="showModal" role="dialog" aria-modal="true">
  <div class="modal-dialog bg-transparent">
    <div class="modal-content shadow custom-modal-content">
      <div class="modal-header custom-modal-header">
        <h5 class="modal-title">Edit Appointment</h5>
        <button type="button" class="btn-close btn-close-white" aria-label="Close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label class="form-label">Patient Name</label>
            <input type="text" class="form-control custom-form-control" [(ngModel)]="patientName" name="patientName"
              required />
          </div>
          <div class="mb-3">
            <label class="form-label">Patient Age</label>
            <input type="number" class="form-control custom-form-control" [(ngModel)]="patientAge" name="patientAge"
              required />
          </div>
          <div class="mb-3">
            <label class="form-label">Problem / Symptoms</label>
            <textarea class="form-control custom-form-control" [(ngModel)]="patientProblem" name="patientProblem"
              required></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer custom-modal-footer">
        <button class="btn btn-cancel" (click)="closeModal()">Cancel</button>
        <button class="btn btn-confirm" (click)="submitAppointmentUpdate()">Update</button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Delete Modal -->
<div class="modal fade show d-block modal-overlay" tabindex="-1" *ngIf="showDeleteModal" role="dialog"
  aria-modal="true">
  <div class="modal-dialog modal-dialog-centered modal-width-sm">
    <div class="modal-content custom-modal-content p-3 shadow">
      <div class="modal-header custom-modal-header">
        <h5 class="modal-title">Confirm Delete</h5>
        <button type="button" class="btn-close btn-close-white" aria-label="Close"
          (click)="closeDeleteModal()"></button>
      </div>
      <div class="modal-body">
        <h5 class="text-danger">Are you sure you want to delete this appointment?</h5>
      </div>
      <div class="modal-footer custom-modal-footer">
        <button class="btn btn-cancel" (click)="closeDeleteModal()">Cancel</button>
        <button class="btn btn-danger" (click)="deleteAppointment()">Yes, Delete</button>
      </div>
    </div>
  </div>
</div>